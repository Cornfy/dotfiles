#!/bin/bash

# --- é…ç½®åŒº ---
REMOTE="root@oneplus12"
REMOTE_PATH="/storage/emulated/0/"
LOCAL_PATH="$HOME/Mobile_Phone_Rsync/"
SSH_PORT="22"

# ç¡®ä¿æœ¬åœ°ç›®å½•å­˜åœ¨
mkdir -p "$LOCAL_PATH"

echo "ğŸ“¥ å¼€å§‹ä»æ‰‹æœº[æ‹‰å–]å¢é‡åŒæ­¥..."

# æ‰§è¡Œ rsync åŒæ­¥
# -a: å½’æ¡£æ¨¡å¼, -h: äººç±»å¯è¯», -u: å¢é‡æ›´æ–°, -P: æ˜¾ç¤ºè¿›åº¦
rsync -ahuP \
	--no-p --no-g --no-o --chmod=D755,F644 \
	--exclude="Android/" \
	--exclude=".thumbnails/" \
	--exclude=".trashed-*" \
	--exclude=".recycle" \
	--exclude="cache/" \
	--exclude=".git/" \
	--exclude=".DS_Store" \
	-e "ssh -p $SSH_PORT" \
	$REMOTE:$REMOTE_PATH \
	$LOCAL_PATH

if [ $? -eq 0 ]; then
    # å¦‚æœ‰éœ€è¦ï¼Œæ‰‹åŠ¨å¤„ç†æƒé™
    # find "$LOCAL_PATH" -type d -exec chmod 755 {} +
    # find "$LOCAL_PATH" -type f -exec chmod 644 {} +
    # chmod -R g-s "$LOCAL_PATH"
    echo "âœ… åŒæ­¥å®Œæˆï¼æ–‡ä»¶å½’å±äº: $(whoami)"
else
    echo "âŒ åŒæ­¥è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ã€‚"
fi
